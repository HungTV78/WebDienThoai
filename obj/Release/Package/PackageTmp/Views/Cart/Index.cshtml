@model List<CodeFirst.Models.Cart>

@{
    ViewBag.Title = "Giỏ hàng";
    Layout = "~/Views/Shared/_LayoutPage1.cshtml";
}

<h2 class="mt-3">@ViewBag.Title</h2>

<table class="table table-bordered">
    <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Quantity</th>
        <th>Total price</th>
        <th>Action</th>
    </tr>
    @{
        int i = 1;
        int totPrice = 0;
    }
    @foreach (var item in Model)
    {
        <tr>
            <td>@i</td>
            <td>@item.Product.Name</td>
            <td>
                @using (Html.BeginForm("UpdateQuantity", "Cart", FormMethod.Get))
                {
                    <input type="number" name="quan" value="@item.Quantity" min="1" style="width: 60px;" />
                    <input type="hidden" name="proid" value="@item.Id" />
                    <input type="submit" value="Update" class="btn btn-warning" />
                }
            </td>
            <td>
                @{
                    int? productPrice = item.Product.Price;
                    int Price = productPrice.HasValue ? item.Quantity * productPrice.Value : 0;
                    totPrice += Price;
                    i++;
                }
                @Price.ToString("N0") VNĐ
            </td>
            <td>
                @using (Html.BeginForm("RemoveFromCart", "Cart", FormMethod.Post))
                {
                    @Html.Hidden("proid", item.Id)
                    <button type="submit" class="btn btn-danger">Remove</button>
                }
            </td>
        </tr>
    }
    <tr>
        <td colspan="3" class="text-center fw-bold">Tổng tiền</td>
        <td>@totPrice.ToString("N0") VNĐ</td>
        <td></td>
    </tr>
</table>

<p>
    <a href="@Url.Action("Index", "Home")" class="btn btn-warning">Tiếp tục mua hàng</a>
    <a href="#" class="btn btn-success">Thanh toán</a>
</p>
